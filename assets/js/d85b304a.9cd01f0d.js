"use strict";(self.webpackChunkmy_website=self.webpackChunkmy_website||[]).push([[7e3],{9613:(e,r,n)=>{n.d(r,{Zo:()=>p,kt:()=>d});var t=n(9496);function a(e,r,n){return r in e?Object.defineProperty(e,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[r]=n,e}function o(e,r){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(e);r&&(t=t.filter((function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable}))),n.push.apply(n,t)}return n}function l(e){for(var r=1;r<arguments.length;r++){var n=null!=arguments[r]?arguments[r]:{};r%2?o(Object(n),!0).forEach((function(r){a(e,r,n[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))}))}return e}function s(e,r){if(null==e)return{};var n,t,a=function(e,r){if(null==e)return{};var n,t,a={},o=Object.keys(e);for(t=0;t<o.length;t++)n=o[t],r.indexOf(n)>=0||(a[n]=e[n]);return a}(e,r);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(t=0;t<o.length;t++)n=o[t],r.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}var i=t.createContext({}),k=function(e){var r=t.useContext(i),n=r;return e&&(n="function"==typeof e?e(r):l(l({},r),e)),n},p=function(e){var r=k(e.components);return t.createElement(i.Provider,{value:r},e.children)},c="mdxType",u={inlineCode:"code",wrapper:function(e){var r=e.children;return t.createElement(t.Fragment,{},r)}},m=t.forwardRef((function(e,r){var n=e.components,a=e.mdxType,o=e.originalType,i=e.parentName,p=s(e,["components","mdxType","originalType","parentName"]),c=k(n),m=a,d=c["".concat(i,".").concat(m)]||c[m]||u[m]||o;return n?t.createElement(d,l(l({ref:r},p),{},{components:n})):t.createElement(d,l({ref:r},p))}));function d(e,r){var n=arguments,a=r&&r.mdxType;if("string"==typeof e||a){var o=n.length,l=new Array(o);l[0]=m;var s={};for(var i in r)hasOwnProperty.call(r,i)&&(s[i]=r[i]);s.originalType=e,s[c]="string"==typeof e?e:a,l[1]=s;for(var k=2;k<o;k++)l[k]=n[k];return t.createElement.apply(null,l)}return t.createElement.apply(null,n)}m.displayName="MDXCreateElement"},4670:(e,r,n)=>{n.r(r),n.d(r,{assets:()=>i,contentTitle:()=>l,default:()=>u,frontMatter:()=>o,metadata:()=>s,toc:()=>k});var t=n(8028),a=(n(9496),n(9613));const o={sidebar_position:26},l=void 0,s={unversionedId:"JavaScript & TypeScript/5.1-\u591a\u7ebf\u7a0b",id:"JavaScript & TypeScript/5.1-\u591a\u7ebf\u7a0b",title:"5.1-\u591a\u7ebf\u7a0b",description:"Create by fall on 22 Nov 2020",source:"@site/my-docs/JavaScript & TypeScript/5.1-\u591a\u7ebf\u7a0b.md",sourceDirName:"JavaScript & TypeScript",slug:"/JavaScript & TypeScript/5.1-\u591a\u7ebf\u7a0b",permalink:"/my-website/docs/JavaScript & TypeScript/5.1-\u591a\u7ebf\u7a0b",draft:!1,editUrl:"https://github.com/my-docs/JavaScript & TypeScript/5.1-\u591a\u7ebf\u7a0b.md",tags:[],version:"current",sidebarPosition:26,frontMatter:{sidebar_position:26},sidebar:"tutorialSidebar",previous:{title:"2.2-\u9762\u5411\u5bf9\u8c61\u7f16\u7a0b",permalink:"/my-website/docs/JavaScript & TypeScript/2.2-\u9762\u5411\u5bf9\u8c61\u7f16\u7a0b"},next:{title:"2.3-\u6a21\u5757\u5316\u5f00\u53d1",permalink:"/my-website/docs/JavaScript & TypeScript/2.3-\u6a21\u5757\u5316\u5f00\u53d1"}},i={},k=[{value:"\u6d4f\u89c8\u5668\u591a\u7ebf\u7a0b",id:"\u6d4f\u89c8\u5668\u591a\u7ebf\u7a0b",level:2},{value:"Web Worker",id:"web-worker",level:2},{value:"\u521b\u5efa Worker",id:"\u521b\u5efa-worker",level:3},{value:"\u7ebf\u7a0b\u901a\u4fe1",id:"\u7ebf\u7a0b\u901a\u4fe1",level:3},{value:"Service Worker",id:"service-worker",level:2},{value:"\u4f7f\u7528\u6b65\u9aa4",id:"\u4f7f\u7528\u6b65\u9aa4",level:3},{value:"\u5b89\u88c5\u548c\u6fc0\u6d3b",id:"\u5b89\u88c5\u548c\u6fc0\u6d3b",level:3},{value:"\u4f7f\u7528",id:"\u4f7f\u7528",level:2},{value:"\u57fa\u672c\u4f7f\u7528",id:"\u57fa\u672c\u4f7f\u7528",level:3},{value:"API",id:"api",level:3},{value:"Worker \u7ebf\u7a0b",id:"worker-\u7ebf\u7a0b",level:3},{value:"\u6570\u636e\u901a\u4fe1",id:"\u6570\u636e\u901a\u4fe1",level:3},{value:"\u529f\u80fd",id:"\u529f\u80fd",level:3},{value:"\u5d4c\u5957worker",id:"\u5d4c\u5957worker",level:3},{value:"\u53c2\u8003\u6587\u7ae0",id:"\u53c2\u8003\u6587\u7ae0",level:2}],p={toc:k},c="wrapper";function u(e){let{components:r,...n}=e;return(0,a.kt)(c,(0,t.Z)({},p,n,{components:r,mdxType:"MDXLayout"}),(0,a.kt)("blockquote",null,(0,a.kt)("p",{parentName:"blockquote"},"Create by ",(0,a.kt)("strong",{parentName:"p"},"fall")," on 22 Nov 2020\nRecently revised in 20 Sep 2023")),(0,a.kt)("h2",{id:"\u6d4f\u89c8\u5668\u591a\u7ebf\u7a0b"},"\u6d4f\u89c8\u5668\u591a\u7ebf\u7a0b"),(0,a.kt)("p",null,"\u591a\u7ebf\u7a0b\u7684\u65b9\u6cd5\u5206\u4e3a\u4ee5\u4e0b\u4e09\u79cd"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"worklet\uff08\u6e32\u67d3\u65f6\u53ef\u4f7f\u7528\u7684\u94a9\u5b50\uff09"),(0,a.kt)("li",{parentName:"ul"},"Service worker\uff08\u7f51\u7edc\u4ee3\u7406\u94a9\u5b50\uff09"),(0,a.kt)("li",{parentName:"ul"},"Web worker\uff08\u51cf\u8f7b\u4e3b\u7ebf\u7a0b\u5de5\u4f5c\u91cf\uff09")),(0,a.kt)("p",null,"Worklet \u662f\u6d4f\u89c8\u5668\u6e32\u67d3\u6d41\u4e2d\u7684\u94a9\u5b50\uff0c\u53ef\u4ee5\u8ba9\u6211\u4eec\u6709\u6d4f\u89c8\u5668\u6e32\u67d3\u7ebf\u7a0b\u4e2d\u5e95\u5c42\u7684\u6743\u9650\uff0c\u6bd4\u5982\u6837\u5f0f\u548c\u5e03\u5c40\u3002"),(0,a.kt)("p",null,"Service worker \u662f\u6d4f\u89c8\u5668\u548c\u7f51\u7edc\u95f4\u7684\u4ee3\u7406\u3002\u901a\u8fc7\u62e6\u622a\u6587\u6863\u4e2d\u53d1\u51fa\u7684\u8bf7\u6c42\uff0cservice worker \u53ef\u4ee5\u76f4\u63a5\u8bf7\u6c42\u7f13\u5b58\u4e2d\u7684\u6570\u636e\uff0c\u8fbe\u5230\u79bb\u7ebf\u8fd0\u884c\u7684\u76ee\u7684\u3002"),(0,a.kt)("p",null,"Web worker \u662f\u901a\u5e38\u76ee\u7684\u662f\u8ba9\u6211\u4eec\u51cf\u8f7b\u4e3b\u7ebf\u7a0b\u4e2d\u7684\u5bc6\u96c6\u5904\u7406\u5de5\u4f5c\u7684\u811a\u672c\u3002"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"\u534f\u7a0b\u662f\u4e00\u79cd\u6bd4\u7ebf\u7a0b\u66f4\u52a0\u8f7b\u91cf\u7ea7\u7684\u5b58\u5728\uff0c\u534f\u7a0b\u53ef\u4ee5\u770b\u6210\u662f\u8dd1\u5728\u7ebf\u7a0b\u4e0a\u7684\u4efb\u52a1\uff0c\u4e00\u4e2a\u7ebf\u7a0b\u53ef\u4ee5\u5b58\u5728\u591a\u4e2a\u534f\u7a0b\uff0c\u4f46\u662f\u540c\u65f6\u53ea\u80fd\u6267\u884c\u4e00\u4e2a\u534f\u7a0b\uff0c\u5982\u679c A \u534f\u7a0b\u542f\u52a8 B \u534f\u7a0b\uff0cA \u4e3a B \u7684\u7236\u534f\u7a0b\uff1b"),(0,a.kt)("li",{parentName:"ul"},"\u534f\u7a0b\u4e0d\u88ab\u64cd\u4f5c\u534f\u540c\u5185\u6838\u6240\u7ba1\u7406\uff0c\u800c\u5b8c\u5168\u7531\u7a0b\u5e8f\u6240\u63a7\u5236\uff0c\u8fd9\u6837\u53ef\u4ee5\u5b9e\u73b0\u6027\u80fd\u63d0\u5347\uff1b")),(0,a.kt)("h2",{id:"web-worker"},"Web Worker"),(0,a.kt)("p",null,"\u4e00\u5957 API \uff0c\u5141\u8bb8\u4e00\u6bb5 JavaScript \u8fd0\u884c\u5728\u4e3b\u7ebf\u7a0b\u4e4b\u5916\u7684\u7ebf\u7a0b\u3002"),(0,a.kt)("p",null,"Web Worker \u5b9a\u4e49\u4e86\u4e24\u7c7b\u5de5\u4f5c\u7ebf\u7a0b\uff0c\u4e13\u7528\u7ebf\u7a0b\uff08Dedicated Worker\uff09\u548c\u5171\u4eab\u7ebf\u7a0b\uff08Shared Worker\uff09"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"\u4e13\u7528\u7ebf\u7a0b\uff1a\u53ea\u80fd\u4e3a\u4e00\u4e2a\u9875\u9762\u6240\u4f7f\u7528"),(0,a.kt)("li",{parentName:"ul"},"\u5171\u4eab\u7ebf\u7a0b\uff1a\u88ab\u591a\u4e2a\u9875\u9762\u5171\u4eab")),(0,a.kt)("h3",{id:"\u521b\u5efa-worker"},"\u521b\u5efa Worker"),(0,a.kt)("p",null,"\u521b\u5efa worker \u548c\u5411 worker \u4e2d\u53d1\u9001\u4fe1\u606f"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-js"},"let worker = new Worker('worker.js')\n// worker.js \u5c31\u662f\u7ebf\u7a0b\u9700\u8981\u6267\u884c\u7684\u4efb\u52a1\uff0c\u7531\u4e8e\u4e0d\u80fd\u8bfb\u53d6\u672c\u5730\u6587\u4ef6\uff0c\u8fd9\u4e2a\u6587\u4ef6\u5fc5\u987b\u6765\u81ea\u7f51\u7edc\n// worker.js \u4e2d\u7684\u4ee3\u7801\nvar i = 0;\nfunction timedCount(){\n    i = i+1;\n    postMessage(i); // worker\u5185\u7684\u72ec\u6709\u51fd\u6570\uff0c\u8d1f\u8d23\u548c\u4e3b\u9875\u9762\u901a\u4fe1\n    setTimeout(timedCount, 1000);\n}\ntimedCount();\n")),(0,a.kt)("p",null,"\u901a\u8fc7URL.createObjectURL() \u521b\u5efa URL \u5bf9\u8c61\uff0c\u53ef\u4ee5\u5b9e\u73b0 worker \u7684\u5185\u5d4c"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-js"},"var myTask = `\n    var i = 0;\n    function timedCount(){\n        i = i+1;\n        postMessage(i);\n        setTimeout(timedCount, 1000);\n    }\n    timedCount();\n`\nvar blob = new Blob([myTask])// \u5c06myTask\u8f6c\u6362\u4e3a\u4e8c\u8fdb\u5236\uff0c\u6ce8\u610f\u8fd9\u4e2a\u4e2d\u62ec\u53f7\nvar myWorker = new Worker(window.URL.createObjectURL(blob));\n// \u4f1a\u5f00\u542f\u4e00\u4e2a\u7ebf\u7a0b\u5e76\u4e14\u6267\u884c myTask\u4e2d\u7684\u4ee3\u7801\n")),(0,a.kt)("h3",{id:"\u7ebf\u7a0b\u901a\u4fe1"},"\u7ebf\u7a0b\u901a\u4fe1"),(0,a.kt)("p",null,"\u7ebf\u7a0b\u901a\u4fe1\u901a\u8fc7\u4e24\u79cd\u65b9\u5f0f\u5b9e\u73b0"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"message \u4e8b\u4ef6\uff0c",(0,a.kt)("inlineCode",{parentName:"li"},"window.addEventListener('message',fun)")),(0,a.kt)("li",{parentName:"ul"},"postMessage ")),(0,a.kt)("p",null,"\u4f20\u9012\u7684\u6570\u636e\u662f\u901a\u8fc7\u62f7\u8d1d\uff0c\u800c\u4e0d\u662f\u5171\u4eab\u6765\u5b8c\u6210\u7684\uff0c\u53ea\u80fd\u5355\u7eaf\u7684\u4f20\u9012\u6570\u636e\u3002\u610f\u5473\u7740\u4f20\u9012\u7ed9 Worker \u5904\u7406\u7684\u5bf9\u8c61\u9700\u8981\u7ecf\u8fc7\u5e8f\u5217\u5316\uff0c\u53e6\u4e00\u7aef\u9700\u8981\u53cd\u5e8f\u5217\u5316\u3002\u5e76\u4e14\u4f20\u9012\u7684\u6570\u636e\u662f\u62f7\u8d1d\u751f\u6210\u7684\u526f\u672c\uff0c\u4fee\u6539\u4e0d\u4f1a\u5f71\u54cd\u53e6\u4e00\u7aef\u63a5\u53d7\u7684\u6570\u636e\u3002"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-js"},"const complexTask = `\n    onmessage = funciton(e){\n        const data = e.data\n        data.push('hello')\n        console.log('worker\u7ebf\u7a0b\u7684data')\n        console.log(data)\n        postMessage(data)\n}`\nconst blob = new Blob([myTask])\nvar myWorker = new Worker(window.URL.createObjectURL(blob))\nmyWorker.onmessage = function(e){\n  const data = e.data\n  console.log('page:',data)\n  console.log('arr:',arr)\n}\nconst arr = [1,2,3]\nmyWorker.postMessage(arr)\n")),(0,a.kt)("h2",{id:"service-worker"},"Service Worker"),(0,a.kt)("p",null,"Service Worker \u53ef\u4ee5\u4f7f\u4f60\u7684\u5e94\u7528\u5148\u8bbf\u95ee\u672c\u5730\u7f13\u5b58\u8d44\u6e90\uff0c\u6240\u4ee5\u5728\u79bb\u7ebf\u72b6\u6001\u65f6\uff0c\u5728\u6ca1\u6709\u901a\u8fc7\u7f51\u7edc\u63a5\u6536\u5230\u66f4\u591a\u7684\u6570\u636e\u524d\uff0c\u4ecd\u53ef\u4ee5\u63d0\u4f9b\u57fa\u672c\u7684\u529f\u80fd"),(0,a.kt)("p",null,"Service Worker \u53ef\u4ee5\u62e6\u622a\u5f53\u524d\u7f51\u7ad9\u6240\u6709\u7684\u8bf7\u6c42,\u8fdb\u884c\u5224\u65ad\uff08\u9700\u8981\u7f16\u5199\u76f8\u5e94\u7684\u5224\u65ad\u7a0b\u5e8f\uff09\uff0c\u5982\u679c\u9700\u8981\u5411\u670d\u52a1\u5668\u53d1"),(0,a.kt)("p",null,"service Worker \u8131\u79bb\u4e8e\u4e3b\u7ebf\u7a0b\u4e4b\u5916\u7684\u7ebf\u7a0b\uff0c\u7528\u4e8e\u89e3\u51b3\u6027\u80fd\u95ee\u9898\uff0c\u4e00\u4e9b\u6d88\u8017\u65f6\u95f4\uff0c\u5e76\u4e14\u590d\u6742\u7684\u8ba1\u7b97\u901a\u8fc7 service Worker \u8fdb\u884c\u8ba1\u7b97\u3002"),(0,a.kt)("p",null,"service worker \u7684\u7279\u70b9"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"\u72ec\u7acb\u7684\u7ebf\u7a0b\uff0c\u6709\u81ea\u5df1\u7684worker content\uff0c\u4e0d\u80fd\u548c\u4e3b\u7ebf\u7a0b\u76f4\u63a5\u901a\u4fe1\uff0c\u5fc5\u987b\u901a\u8fc7\u6d88\u606f\u5b8c\u6210\u3002"),(0,a.kt)("li",{parentName:"ul"},"\u4e0d\u80fd\u4f7f\u7528\u8bf8\u5982 ",(0,a.kt)("inlineCode",{parentName:"li"},"alert()")," \u548c ",(0,a.kt)("inlineCode",{parentName:"li"},"confirm()")," \u65b9\u6cd5"),(0,a.kt)("li",{parentName:"ul"},"\u4e00\u65e6\u88ab install \u5c31\u4f1a\u4e00\u76f4\u5b58\u5728\uff0c\u9664\u975e\u88ab uninstall"),(0,a.kt)("li",{parentName:"ul"},"\u4e0d\u9700\u8981\u65f6\uff0c\u4f1a\u8fdb\u884c\u4f11\u7720"),(0,a.kt)("li",{parentName:"ul"},"\u53ef\u4ee5\u62e6\u622a\u4ee3\u7406\u8bf7\u6c42\u548c\u8fd4\u56de\uff0c\u7f13\u5b58\u7684\u6587\u4ef6\u53ef\u4ee5\u88ab\u8bfb\u53d6\u5230"),(0,a.kt)("li",{parentName:"ul"},"\u79bb\u7ebf\u7684\u5185\u5bb9\uff0c\u5f00\u53d1\u8005\u53ef\u63a7"),(0,a.kt)("li",{parentName:"ul"},"\u53ef\u4ee5\u5411\u5ba2\u6237\u7aef\u63a8\u9001\u4fe1\u606f"),(0,a.kt)("li",{parentName:"ul"},"\u5206\u914d\u7ed9 Worker \u7ebf\u7a0b\u8fd0\u884c\u7684\u811a\u672c\u6587\u4ef6\uff0c\u5fc5\u987b\u4e0e\u4e3b\u7ebf\u7a0b\u7684\u811a\u672c\u6587\u4ef6\u540c\u6e90\u3002"),(0,a.kt)("li",{parentName:"ul"},"\u4e0d\u80fd\u76f4\u63a5\u64cd\u4f5c DOM"),(0,a.kt)("li",{parentName:"ul"},"\u4e0d\u80fd\u64cd\u4f5c\u672c\u5730\u78c1\u76d8\u4e2d\u7684\u6570\u636e"),(0,a.kt)("li",{parentName:"ul"},"\u5fc5\u987b\u662f https \u534f\u8bae\uff0c\u6216\u8005\u662f localhost \u73af\u5883\u4e0b\u624d\u80fd\u5de5\u4f5c")),(0,a.kt)("p",null,"\u5206\u914d\u7ed9 Worker \u7ebf\u7a0b\u8fd0\u884c\u7684\u811a\u672c\u6587\u4ef6\uff0c\u5fc5\u987b\u4e0e\u4e3b\u7ebf\u7a0b\u7684\u811a\u672c\u6587\u4ef6\u540c\u6e90\u3002"),(0,a.kt)("h3",{id:"\u4f7f\u7528\u6b65\u9aa4"},"\u4f7f\u7528\u6b65\u9aa4"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"service worker URL \u901a\u8fc7 ",(0,a.kt)("inlineCode",{parentName:"li"},"serviceWorkerContainer.register()")," \u7528\u4e8e\u83b7\u53d6\u548c\u6ce8\u518c"),(0,a.kt)("li",{parentName:"ul"},"\u6ce8\u518c\u6210\u529f\uff0cservice worker \u5c31\u5728 ",(0,a.kt)("inlineCode",{parentName:"li"},"ServiceWorkerGlobalScope")," \u73af\u5883\u4e2d\u8fd0\u884c\uff0c\u8be5\u73af\u5883\u4e0e\u4e3b\u7ebf\u7a0b\u72ec\u7acb\uff0c\u540c\u65f6\u6ca1\u6709\u8bbf\u95ee DOM \u7684\u80fd\u529b"),(0,a.kt)("li",{parentName:"ul"},"\u53ef\u4ee5\u8fdb\u884c\u5904\u7406\u4e8b\u4ef6"),(0,a.kt)("li",{parentName:"ul"},"service worker \u63a7\u5236\u7684\u9875\u9762\u6253\u5f00\u540e\u4f1a\u5c1d\u8bd5\u53bb\u5b89\u88c5 service worker\uff0c\u6700\u5148\u53d1\u9001\u7ed9 service worker \u7684\u4e8b\u4ef6\u662f\u5b89\u88c5\u4e8b\u4ef6\uff08\u5728\u8be5\u4e8b\u4ef6\u5185\u53ef\u4ee5\u5f00\u59cb\u8fdb\u884c\u586b\u5145 IndexDB \u548c\u7f13\u5b58\u7ad9\u70b9\u8d44\u6e90\uff09\uff0c\u8ba9\u6240\u6709\u8d44\u6e90\u53ef\u4ee5\u79bb\u7ebf\u8bbf\u95ee\u3002"),(0,a.kt)("li",{parentName:"ul"},"oninstall \u4e8b\u4ef6\u5904\u7406\u7a0b\u5e8f\u6267\u884c\u5b8c\u6210\u4e4b\u540e\uff0c\u5c31\u53ef\u4ee5\u8ba4\u4e3a service worker \u5df2\u7ecf\u5b89\u88c5\u5b8c\u6210\u4e86"),(0,a.kt)("li",{parentName:"ul"},"\u7136\u540e\u662f\u6fc0\u6d3b\uff0cservice worker \u5b89\u88c5\u5b8c\u6210\u4e4b\u540e\uff0c\u4f1a\u6536\u5230\u6fc0\u6d3b\u4e8b\u4ef6\u3002 ",(0,a.kt)("inlineCode",{parentName:"li"},"onactivate")," \u4e3b\u8981\u7528\u9014\u662f\u6e05\u7406\u5148\u524d\u7248\u672c\u7684 service worker \u811a\u672c\u4e2d\u4f7f\u7528\u7684\u8d44\u6e90\u3002"),(0,a.kt)("li",{parentName:"ul"},"Service Worker \u73b0\u5728\u53ef\u4ee5\u63a7\u5236\u9875\u9762\uff0c\u4f46\u4ec5\u5728 ",(0,a.kt)("inlineCode",{parentName:"li"},"register()")," \u6210\u529f\u540e\u6253\u5f00\u7684\u9875\u9762\uff0c\u4e5f\u5c31\u662f\u8bf4\uff0c\u9875\u9762\u8d77\u59cb\u4e8e\u6709\u6ca1\u6709 service worker \u5e76\u4e14\u5728\u63a5\u4e0b\u6765\u7684\u751f\u547d\u5468\u671f\u7ef4\u6301\u8fd9\u4e2a\u72b6\u6001\uff0c\u6240\u4ee5\u4e0d\u5f97\u4e0d\u91cd\u65b0\u52a0\u8f7d\u8ba9 service worker \u91cd\u65b0\u83b7\u5f97\u63a7\u5236\u3002")),(0,a.kt)("p",null,"\u652f\u6301\u7684\u4e8b\u4ef6"),(0,a.kt)("p",null,(0,a.kt)("inlineCode",{parentName:"p"},"install"),"\u3001",(0,a.kt)("inlineCode",{parentName:"p"},"activate"),"\u3001",(0,a.kt)("inlineCode",{parentName:"p"},"message"),"\u3001",(0,a.kt)("inlineCode",{parentName:"p"},"fetch"),"\u3001",(0,a.kt)("inlineCode",{parentName:"p"},"sync"),"\u3001",(0,a.kt)("inlineCode",{parentName:"p"},"push")),(0,a.kt)("p",null,"\u6ce8\u518c service worker"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-js"},"if('serviceWorker' in navigator){ // \u786e\u4fdd\u6d4f\u89c8\u5668\u652f\u6301 service worker\n  // \u6ce8\u518c\u7ad9\u70b9\u7684 service worker \n  // \u8def\u5f84\u4e3a\u76f8\u5bf9\u4e8e origin \u7684\u6587\u4ef6\u8def\u5f84\uff0c\u5982 https://mdn.github.io/sw-test/sw.js \u5f15\u5165\u5e94\u8be5\u4e3a /sw-test/sw.js\n  // scope \u4e3a\u9009\u586b\u7684\u5185\u5bb9\n  navigator.serviceWorker.register('/sw-test/sw.js',{scope:'/sw-test/'}).then(function(reg){\n    // worked\n    console.log('\u6210\u529f')\n  }).catch(function(error){\n    // failed\n    console.log('Registration failed with '+ error)\n  })\n}\n")),(0,a.kt)("blockquote",null,(0,a.kt)("p",{parentName:"blockquote"},"\u5355\u4e2a service worker \u53ef\u4ee5\u63a7\u5236\u5f88\u591a\u9875\u9762\uff0c\u6bcf\u4e2a scope \u91cc\u7684\u9875\u9762\u52a0\u8f7d\u5b8c\u7684\u65f6\u5019\uff0c\u5b89\u88c5\u5728\u9875\u9762\u7684 service worker \u53ef\u4ee5\u63a7\u5236\u5b83\uff0c\u5c0f\u5fc3 service worker \u4e2d\u7684\u5168\u5c40\u53d8\u91cf\uff0c\u6bcf\u4e2a\u9875\u9762\u4e0d\u4f1a\u6709\u81ea\u5df1\u72ec\u6709\u7684 worker\u3002")),(0,a.kt)("h3",{id:"\u5b89\u88c5\u548c\u6fc0\u6d3b"},"\u5b89\u88c5\u548c\u6fc0\u6d3b"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-js"},"this.addEventListener('install',function(event){\n  event.waitUntil(\n    caches.open('v1').then(function(cache){\n      return cache.addAll([\n        '/sw-test/',\n        '/sw-test/index.html',\n        '/sw-test/style.css',\n        '/sw-test/app.js',\n        '/sw-test/star-wars-logo.jpg',\n      ])\n    })\n  )\n})\n")),(0,a.kt)("blockquote",null,(0,a.kt)("p",{parentName:"blockquote"},"localStorage \u5b83\u662f\u540c\u6b65\u7684\uff0c\u4e0d\u5141\u8bb8\u5728 service workers \u5185\u4f7f\u7528\u3002")),(0,a.kt)("p",null,"\u73b0\u5728\u5df2\u7ecf\u6709\u4e86\u7ad9\u70b9\u5185\u5bb9\u7684\u7f13\u5b58\uff0c\u4f60\u53ef\u4ee5\u901a\u8fc7 fetch \u4e8b\u4ef6\u544a\u8bc9 service worker \u8ba9\u5b83\u7528\u8fd9\u4e9b\u7f13\u5b58\u5185\u5bb9\u3002"),(0,a.kt)("p",null,"\u6240\u6709\u88ab service woker \u63a7\u5236\u7684\u8d44\u6e90\u6bcf\u6b21\u88ab\u8bf7\u6c42\u5230\u65f6\uff0c\u90fd\u4f1a\u89e6\u53d1 ",(0,a.kt)("inlineCode",{parentName:"p"},"fetch")," \u4e8b\u4ef6\u5417"),(0,a.kt)("h2",{id:"\u4f7f\u7528"},"\u4f7f\u7528"),(0,a.kt)("h3",{id:"\u57fa\u672c\u4f7f\u7528"},"\u57fa\u672c\u4f7f\u7528"),(0,a.kt)("p",null,"\u8c03\u7528 ",(0,a.kt)("inlineCode",{parentName:"p"},"Worker()")," \u6784\u9020\u51fd\u6570\uff0c\u4f1a\u6784\u5efa\u4e00\u4e2a Worker \u7ebf\u7a0b"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-js"},"var jsUrl = 'worker.js'\nvar options ={ name : 'myWorker' }\nvar myWorker = new Worker(jsUrl, options);\n")),(0,a.kt)("p",null,"\u63a5\u53d7\u4fe1\u606f"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-js"},"worker.postMessage('hello world')\n// \u4e3b\u7ebf\u7a0b\u901a\u8fc7 worker.postMessage \u5411 worker \u53d1\u6d88\u606f\nworker.postMessage({method: 'echo', args: ['Work']});\n")),(0,a.kt)("p",null,(0,a.kt)("inlineCode",{parentName:"p"},"worker.onmessage()")," \u8fdb\u884c\u63a5\u6536\u6570\u636e"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-js"},"worker.onmessage() // \u7528\u4e8e\u63a5\u6536\u4fe1\u606f\nworker.onmessage = function (event) {\n  console.log('Received message ' + event.data);\n  doSomething();\n}\n\nfunction doSomething() {\n  // \u6267\u884c\u4efb\u52a1\n  worker.postMessage('Work done!');\n}\n")),(0,a.kt)("p",null,"\u4f7f\u7528\u5b8c\u6210\u540e\u8fdb\u884c\u5173\u95ed"),(0,a.kt)("p",null,(0,a.kt)("inlineCode",{parentName:"p"},"worker.terminate()")," "),(0,a.kt)("h3",{id:"api"},"API"),(0,a.kt)("p",null,"\u6d4f\u89c8\u5668\u539f\u751f\u63d0\u4f9b",(0,a.kt)("inlineCode",{parentName:"p"},"Worker()"),"\u6784\u9020\u51fd\u6570\uff0c\u7528\u6765\u4f9b\u4e3b\u7ebf\u7a0b\u751f\u6210 Worker \u7ebf\u7a0b\u3002"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-javascript"},"var myWorker = new Worker(jsUrl, options);\n// \u7b2c\u4e00\u4e2a\u53c2\u6570\u662f\u811a\u672c\u7684\u7f51\u5740\uff0c\u4e14\u5fc5\u987b\u9075\u5b88\u540c\u6e90\u653f\u7b56\uff0c\u4e14\u53ea\u80fd\u52a0\u8f7d JS \u811a\u672c\uff08\u5fc5\u9700\uff09\n// \u7b2c\u4e8c\u4e2a\u53c2\u6570\u662f\u914d\u7f6e\u5bf9\u8c61\uff0c\u8be5\u5bf9\u8c61\u53ef\u9009\u3002\u5b83\u7684\u4e00\u4e2a\u4f5c\u7528\u5c31\u662f\u6307\u5b9a Worker \u7684\u540d\u79f0\uff0c\u7528\u6765\u533a\u5206\u591a\u4e2a Worker \u7ebf\u7a0b\u3002\n// \u793a\u4f8b\nvar myWorker = new Worker('worker.js', { name : 'myWorker' });\n")),(0,a.kt)("p",null,"\u5b9e\u4f8b\u65b9\u6cd5"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-js"},"let worker = new Worker('worker.js', { name : 'myWorker' });\nworker.onerror// \u6307\u5b9a error \u4e8b\u4ef6\u7684\u76d1\u542c\u51fd\u6570\u3002\nworker.onmessage// message \u4e8b\u4ef6\u7684\u76d1\u542c\u51fd\u6570\uff0c\u53d1\u9001\u8fc7\u6765\u7684\u6570\u636e\u5728Event.data\u5c5e\u6027\u4e2d\u3002\nworker.onmessageerror// \u6307\u5b9a messageerror \u4e8b\u4ef6\u7684\u76d1\u542c\u51fd\u6570\u3002\u53d1\u9001\u7684\u6570\u636e\u65e0\u6cd5\u5e8f\u5217\u5316\u6210\u5b57\u7b26\u4e32\u65f6\uff0c\u4f1a\u89e6\u53d1\u8fd9\u4e2a\u4e8b\u4ef6\u3002\nworker.postMessage()// \u5411 Worker \u7ebf\u7a0b\u53d1\u9001\u6d88\u606f\u3002\nworker.terminate()// \u7acb\u5373\u7ec8\u6b62 Worker \u7ebf\u7a0b\u3002\n")),(0,a.kt)("p",null,"\u53bf\u57ce\u4e0a\u7684API"),(0,a.kt)("p",null,"Web Worker \u6709\u81ea\u5df1\u7684\u5168\u5c40\u5bf9\u8c61\uff0c\u4e0d\u662f\u4e3b\u7ebf\u7a0b\u7684window\uff0c\u800c\u662f\u4e00\u4e2a\u4e13\u95e8\u4e3a Worker \u5b9a\u5236\u7684\u5168\u5c40\u5bf9\u8c61\u3002\u56e0\u6b64\u5b9a\u4e49\u5728window\u4e0a\u9762\u7684\u5bf9\u8c61\u548c\u65b9\u6cd5\u4e0d\u662f\u5168\u90e8\u90fd\u53ef\u4ee5\u4f7f\u7528\u3002"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-js"},"self.name           // worker \u7684\u540d\u5b57\u3002\u8be5\u5c5e\u6027\u53ea\u8bfb\uff0c\u7531\u6784\u9020\u51fd\u6570\u6307\u5b9a\u3002\nself.onmessage      // \u6307\u5b9amessage\u4e8b\u4ef6\u7684\u76d1\u542c\u51fd\u6570\u3002\nself.onmessageerror\n// \u6307\u5b9a messageerror \u4e8b\u4ef6\u7684\u76d1\u542c\u51fd\u6570\u3002\u53d1\u9001\u7684\u6570\u636e\u65e0\u6cd5\u5e8f\u5217\u5316\u6210\u5b57\u7b26\u4e32\u65f6\uff0c\u4f1a\u89e6\u53d1\u8fd9\u4e2a\u4e8b\u4ef6\u3002\nself.close()        //\u5173\u95ed Worker \u7ebf\u7a0b\u3002\nself.postMessage()  //\u5411\u4ea7\u751f\u8fd9\u4e2a Worker \u7ebf\u7a0b\u53d1\u9001\u6d88\u606f\u3002\nself.importScripts()//\u52a0\u8f7d JS \u811a\u672c\u3002\n")),(0,a.kt)("h3",{id:"worker-\u7ebf\u7a0b"},"Worker \u7ebf\u7a0b"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-js"},"// self\u4ee3\u8868\u5b50\u7ebf\u7a0b\u81ea\u8eab\uff0c\u5373\u5b50\u7ebf\u7a0b\u7684\u5168\u5c40\u5bf9\u8c61\u3002\nself.addEventListener('message',function(ev){\n  self.postMessage('you said', ev.data)\n},false) \n")),(0,a.kt)("p",null,"\u6839\u636e\u4e3b\u7ebf\u7a0b\u53d1\u8fc7\u6765\u7684\u6570\u636e\uff0cworker\u7ebf\u7a0b\u53ef\u4ee5\u8c03\u7528\u4e0d\u540c\u7684\u65b9\u6cd5"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-javascript"},"self.addEventListener('message', function (e) {\n  var data = e.data;\n  switch (data.cmd) {\n    case 'start':\n      self.postMessage('WORKER STARTED: ' + data.msg);\n      break;\n    case 'stop':\n      self.postMessage('WORKER STOPPED: ' + data.msg);\n      self.close(); // Terminates the worker.\n      break;\n    default:\n      self.postMessage('Unknown command: ' + data.msg);\n  };\n}, false);\n")),(0,a.kt)("p",null,"\u52a0\u8f7d\u811a\u672c"),(0,a.kt)("p",null,"\u5982\u679c\u60f3\u8981\u5728 service \u5185\u90e8\u52a0\u8f7d\u811a\u672c\uff0c\u53ef\u4ee5\u4f7f\u7528 ",(0,a.kt)("inlineCode",{parentName:"p"},"importScript()")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-js"},"importScripts('script1.js');\n// \u53ef\u4ee5\u540c\u65f6\u52a0\u8f7d\u591a\u4e2a\u811a\u672c\nimportScripts('script1.js', 'script2.js');\n")),(0,a.kt)("p",null,"\u9519\u8bef\u5904\u7406"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-js"},"worker.onerror(function (event) {\n  console.log([\n    'ERROR: Line ', e.lineno, ' in ', e.filename, ': ', e.message\n  ].join(''));\n});\n// \u6216\u8005\nworker.addEventListener('error', function (event) {\n  // ...\n});\n")),(0,a.kt)("h3",{id:"\u6570\u636e\u901a\u4fe1"},"\u6570\u636e\u901a\u4fe1"),(0,a.kt)("p",null,"\u5904\u7406 service worker \u65f6\uff0c\u6d4f\u89c8\u5668\u5185\u90e8\u7684\u8fd0\u884c\u673a\u5236\u662f\uff0c\u5148\u5c06\u901a\u4fe1\u5185\u5bb9\u4e32\u884c\u5316\uff0c\u7136\u540e\u628a\u4e32\u884c\u5316\u540e\u7684\u5b57\u7b26\u4e32\u53d1\u7ed9 Worker\uff0c\u540e\u8005\u518d\u5c06\u5b83\u8fd8\u539f\u3002"),(0,a.kt)("p",null,"\u901a\u4fe1\u5185\u5bb9\uff0c\u53ef\u4ee5\u662f\u6587\u672c\uff0c\u4e5f\u53ef\u4ee5\u662f\u5bf9\u8c61\u3002\u4f46\u5e76\u4e0d\u662f\u666e\u901a\u7684\u4f20\u5740\uff0c\u800c\u662f\u62f7\u8d1d\u3002"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-js"},"var uInt8Array = new Uint8Array(new ArrayBuffer(10));\nfor (var i = 0; i < uInt8Array.length; ++i) {\n  uInt8Array[i] = i * 2; // [0, 2, 4, 6, 8,...]\n}\nworker.postMessage(uInt8Array);\n\n// Worker \u7ebf\u7a0b\nself.onmessage = function (e) {\n  var uInt8Array = e.data;\n  postMessage('Inside worker.js: uInt8Array.toString() = ' + uInt8Array.toString());\n  postMessage('Inside worker.js: uInt8Array.byteLength = ' + uInt8Array.byteLength);\n};\n")),(0,a.kt)("p",null,"\u62f7\u8d1d\u65b9\u5f0f\u53d1\u9001\u4e8c\u8fdb\u5236\u6570\u636e\uff0c\u4f1a\u9020\u6210\u6027\u80fd\u95ee\u9898\u3002\u5927\u6587\u4ef6\u4f20\u8f93\u7684\u8bdd\uff0c\u9700\u8981\u989d\u5916\u4f7f\u7528\u7ebf\u7a0b\u53bb\u89e3\u51b3\uff0c\u5e76\u4e14\u8fdb\u884c\u4f20\u8f93\u3002\u4e86\u89e3\u51b3\u8fd9\u4e2a\u95ee\u9898\uff0cJavaScript \u5141\u8bb8\u4e3b\u7ebf\u7a0b\u628a\u4e8c\u8fdb\u5236\u6570\u636e\u76f4\u63a5\u8f6c\u79fb\u7ed9\u5b50\u7ebf\u7a0b\uff0c\u4f46\u662f\u4e00\u65e6\u8f6c\u79fb\uff0c\u4e3b\u7ebf\u7a0b\u5c31\u65e0\u6cd5\u518d\u4f7f\u7528\u8fd9\u4e9b\u4e8c\u8fdb\u5236\u6570\u636e\u4e86\uff0c\u8fd9\u662f\u4e3a\u4e86\u9632\u6b62\u51fa\u73b0\u591a\u4e2a\u7ebf\u7a0b\u540c\u65f6\u4fee\u6539\u6570\u636e\u7684\u9ebb\u70e6\u5c40\u9762\u3002\u8fd9\u79cd\u8f6c\u79fb\u6570\u636e\u7684\u65b9\u6cd5\uff0c\u53eb\u505a",(0,a.kt)("a",{parentName:"p",href:"https://www.w3.org/html/wg/drafts/html/master/infrastructure.html#transferable-objects"},"Transferable Objects"),"\u3002\u8fd9\u4f7f\u5f97\u4e3b\u7ebf\u7a0b\u53ef\u4ee5\u5feb\u901f\u628a\u6570\u636e\u4ea4\u7ed9 Worker\uff0c\u5bf9\u4e8e\u5f71\u50cf\u5904\u7406\u3001\u58f0\u97f3\u5904\u7406\u30013D \u8fd0\u7b97\u7b49\u5c31\u975e\u5e38\u65b9\u4fbf\u4e86\uff0c\u4e0d\u4f1a\u4ea7\u751f\u6027\u80fd\u8d1f\u62c5\u3002"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-js"},"// Transferable Objects \u683c\u5f0f\nworker.postMessage(arrayBuffer, [arrayBuffer]);\n\n// \u4f8b\u5b50\nvar ab = new ArrayBuffer(1);\nworker.postMessage(ab, [ab]);\n")),(0,a.kt)("h3",{id:"\u529f\u80fd"},"\u529f\u80fd"),(0,a.kt)("p",null,(0,a.kt)("strong",{parentName:"p"},"\u5b9e\u73b0 webworker \u548c js \u5728\u540c\u4e00\u4e2a\u754c\u9762")),(0,a.kt)("p",null,"\u5d4c\u5165\u7f51\u9875\u7684\u811a\u672c\uff0c\u6307\u5b9a",(0,a.kt)("inlineCode",{parentName:"p"},"<script>"),"\u6807\u7b7e\u7684",(0,a.kt)("inlineCode",{parentName:"p"},"type"),"\u5c5e\u6027\u662f\u4e00\u4e2a\u6d4f\u89c8\u5668\u4e0d\u8ba4\u8bc6\u7684\u503c\uff0c\u7136\u540e\uff0c\u8bfb\u53d6\u8fd9\u4e00\u6bb5\u5d4c\u5165\u9875\u9762\u7684\u811a\u672c\uff0c\u7528 Worker \u6765\u5904\u7406\u3002"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-html"},"<script id=\"worker\" type=\"app/worker\">\n    addEventListener('message', function () {\n        postMessage('some message');\n      }, false);\n<\/script>\n")),(0,a.kt)("p",null,"\u5148\u5c06\u5d4c\u5165\u7f51\u9875\u7684\u811a\u672c\u4ee3\u7801\uff0c\u8f6c\u6210\u4e00\u4e2a\u4e8c\u8fdb\u5236\u5bf9\u8c61\uff0c\u7136\u540e\u4e3a\u8fd9\u4e2a\u4e8c\u8fdb\u5236\u5bf9\u8c61\u751f\u6210 URL\uff0c\u518d\u8ba9 Worker \u52a0\u8f7d\u8fd9\u4e2a URL\u3002\u8fd9\u6837\u5c31\u505a\u5230\u4e86\uff0c\u4e3b\u7ebf\u7a0b\u548c Worker \u7684\u4ee3\u7801\u90fd\u5728\u540c\u4e00\u4e2a\u7f51\u9875\u4e0a\u9762\u3002"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-js"},"var blob = new Blob([document.querySelector('#worker').textContent]);\nvar url = window.URL.createObjectURL(blob);\nvar worker = new Worker(url);\nworker.onmessage = function (e) {\n  // e.data === 'some message'\n};\n")),(0,a.kt)("p",null,(0,a.kt)("strong",{parentName:"p"},"worker \u5b9e\u73b0\u8f6e\u8be2")),(0,a.kt)("p",null,"\u9700\u8981\u67e5\u770b\u670d\u52a1\u5668\u72b6\u6001\uff0c\u4ee5\u4fbf\u7b2c\u4e00\u65f6\u95f4\u83b7\u53d6\u72b6\u6001\u7684\u6539\u53d8\u3002"),(0,a.kt)("p",null,"\u4ee5\u4e0b\u4ee3\u7801\u5b9e\u73b0Worker \u6bcf\u79d2\u949f\u8f6e\u8be2\u4e00\u6b21\u6570\u636e\uff0c\u7136\u540e\u8ddf\u7f13\u5b58\u505a\u6bd4\u8f83\u3002\u5982\u679c\u4e0d\u4e00\u81f4\uff0c\u5c31\u8bf4\u660e\u670d\u52a1\u7aef\u6709\u4e86\u65b0\u7684\u53d8\u5316\uff0c\u56e0\u6b64\u5c31\u8981\u901a\u77e5\u4e3b\u7ebf\u7a0b\u3002"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-js"},"function createWorker(f) {\n  var blob = new Blob(['(' + f.toString() +')()']);\n  var url = window.URL.createObjectURL(blob);\n  var worker = new Worker(url);\n  return worker;\n}\nvar pollingWorker = createWorker(function (e) {\n  var cache;\n  function compare(new, old) {  }; // {...}\n  setInterval(function () {\n    fetch('/my-api-endpoint').then(function (res) {\n      var data = res.json();\n      if (!compare(data, cache)) {\n        cache = data;\n        self.postMessage(data);\n      }\n    })\n  }, 1000)\n})\npollingWorker.onmessage = function () {\n  // render data\n}\npollingWorker.postMessage('init');\n")),(0,a.kt)("h3",{id:"\u5d4c\u5957worker"},"\u5d4c\u5957worker"),(0,a.kt)("p",null,"Worker \u7ebf\u7a0b\u5185\u90e8\u8fd8\u80fd\u518d\u65b0\u5efa Worker \u7ebf\u7a0b\uff08\u76ee\u524d\u53ea\u6709 Firefox \u6d4f\u89c8\u5668\u652f\u6301\uff09\u3002\u4e0b\u9762\u7684\u4f8b\u5b50\u662f\u5c06\u4e00\u4e2a\u8ba1\u7b97\u5bc6\u96c6\u7684\u4efb\u52a1\uff0c\u5206\u914d\u523010\u4e2a Worker\u3002"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-js"},"var worker = new Worker('worker.js');\nworker.onmessage = function (event) {\n  document.getElementById('result').textContent = event.data;\n};\n")),(0,a.kt)("p",null,"\u4e0b\u9762\u4ee3\u7801 \u5c06\u5728 Worker \u7ebf\u7a0b\u5185\u90e8\u65b0\u5efa\u4e8610\u4e2a Worker \u7ebf\u7a0b\uff0c\u5e76\u4e14\u4f9d\u6b21\u5411\u8fd910\u4e2a Worker \u53d1\u9001\u6d88\u606f\uff0c\u544a\u77e5\u4e86\u8ba1\u7b97\u7684\u8d77\u70b9\u548c\u7ec8\u70b9\u3002"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-js"},"// worker.js\n\n// settings\nvar num_workers = 10;\nvar items_per_worker = 1000000;\n\n// start the workers\nvar result = 0;\nvar pending_workers = num_workers;\nfor (var i = 0; i < num_workers; i += 1) {\n  var worker = new Worker('core.js');\n  worker.postMessage(i * items_per_worker);\n  worker.postMessage((i + 1) * items_per_worker);\n  worker.onmessage = storeResult;\n}\n// handle the results\nfunction storeResult(event) {\n  result += event.data;\n  pending_workers -= 1;\n  if (pending_workers <= 0)\n    postMessage(result); // finished!\n}\n")),(0,a.kt)("p",null,"\u9700\u8981\u6267\u884c\u7684\u4ee3\u7801"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-js"},"// core.js\nvar start;\nonmessage = getStart;\nfunction getStart(event) {\n  start = event.data;\n  onmessage = getEnd;\n}\nvar end;\nfunction getEnd(event) {\n  end = event.data;\n  onmessage = null;\n  work();\n}\nfunction work() {\n  var result = 0;\n  for (var i = start; i < end; i += 1) {\n    // perform some complex calculation here\n    result += 1;\n  }\n  postMessage(result);\n  close();\n}\n")),(0,a.kt)("h2",{id:"\u53c2\u8003\u6587\u7ae0"},"\u53c2\u8003\u6587\u7ae0"),(0,a.kt)("table",null,(0,a.kt)("thead",{parentName:"table"},(0,a.kt)("tr",{parentName:"thead"},(0,a.kt)("th",{parentName:"tr",align:null},"\u4f5c\u8005"),(0,a.kt)("th",{parentName:"tr",align:null},"\u94fe\u63a5"))),(0,a.kt)("tbody",{parentName:"table"},(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"\u8003\u62c9\u6d77\u8d2d\u524d\u7aef\u56e2\u961f"),(0,a.kt)("td",{parentName:"tr",align:null},(0,a.kt)("a",{parentName:"td",href:"https://juejin.cn/post/6844903496550989837"},"https://juejin.cn/post/6844903496550989837"))),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"MDN\u5b98\u65b9\u6587\u6863"),(0,a.kt)("td",{parentName:"tr",align:null},(0,a.kt)("a",{parentName:"td",href:"https://developer.mozilla.org/zh-CN/docs/Web/API/Service_Worker_API/Using_Service_Workers"},"https://developer.mozilla.org/zh-CN/docs/Web/API/Service_Worker_API/Using_Service_Workers"))),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"\u5f20\u9a70Terry"),(0,a.kt)("td",{parentName:"tr",align:null},(0,a.kt)("a",{parentName:"td",href:"https://juejin.cn/post/6979758006711877640"},"https://juejin.cn/post/6979758006711877640"))))))}u.isMDXComponent=!0}}]);