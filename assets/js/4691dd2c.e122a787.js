"use strict";(self.webpackChunkmy_website=self.webpackChunkmy_website||[]).push([[8680],{9613:(e,n,t)=>{t.d(n,{Zo:()=>u,kt:()=>k});var r=t(9496);function a(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function s(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,r)}return t}function o(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?s(Object(t),!0).forEach((function(n){a(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):s(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function l(e,n){if(null==e)return{};var t,r,a=function(e,n){if(null==e)return{};var t,r,a={},s=Object.keys(e);for(r=0;r<s.length;r++)t=s[r],n.indexOf(t)>=0||(a[t]=e[t]);return a}(e,n);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(r=0;r<s.length;r++)t=s[r],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(a[t]=e[t])}return a}var p=r.createContext({}),i=function(e){var n=r.useContext(p),t=n;return e&&(t="function"==typeof e?e(n):o(o({},n),e)),t},u=function(e){var n=i(e.components);return r.createElement(p.Provider,{value:n},e.children)},c="mdxType",d={inlineCode:"code",wrapper:function(e){var n=e.children;return r.createElement(r.Fragment,{},n)}},m=r.forwardRef((function(e,n){var t=e.components,a=e.mdxType,s=e.originalType,p=e.parentName,u=l(e,["components","mdxType","originalType","parentName"]),c=i(t),m=a,k=c["".concat(p,".").concat(m)]||c[m]||d[m]||s;return t?r.createElement(k,o(o({ref:n},u),{},{components:t})):r.createElement(k,o({ref:n},u))}));function k(e,n){var t=arguments,a=n&&n.mdxType;if("string"==typeof e||a){var s=t.length,o=new Array(s);o[0]=m;var l={};for(var p in n)hasOwnProperty.call(n,p)&&(l[p]=n[p]);l.originalType=e,l[c]="string"==typeof e?e:a,o[1]=l;for(var i=2;i<s;i++)o[i]=t[i];return r.createElement.apply(null,o)}return r.createElement.apply(null,t)}m.displayName="MDXCreateElement"},6712:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>p,contentTitle:()=>o,default:()=>d,frontMatter:()=>s,metadata:()=>l,toc:()=>i});var r=t(8028),a=(t(9496),t(9613));const s={},o=void 0,l={unversionedId:"npm \u5305/axios",id:"npm \u5305/axios",title:"axios",description:"Create by fall on 2020-08-15",source:"@site/my-docs/npm \u5305/axios.md",sourceDirName:"npm \u5305",slug:"/npm \u5305/axios",permalink:"/my-website/docs/npm \u5305/axios",draft:!1,editUrl:"https://github.com/my-docs/npm \u5305/axios.md",tags:[],version:"current",frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"git\u5de5\u5177",permalink:"/my-website/docs/git\u5de5\u5177"},next:{title:"babel",permalink:"/my-website/docs/npm \u5305/babel"}},p={},i=[{value:"axios",id:"axios",level:2},{value:"\u8bf7\u6c42",id:"\u8bf7\u6c42",level:3},{value:"\u8fd4\u56de\u5bf9\u8c61",id:"\u8fd4\u56de\u5bf9\u8c61",level:3},{value:"\u5168\u5c40\u914d\u7f6e",id:"\u5168\u5c40\u914d\u7f6e",level:3},{value:"\u62e6\u622a\u5668",id:"\u62e6\u622a\u5668",level:3},{value:"\u9002\u914d\u5668",id:"\u9002\u914d\u5668",level:3},{value:"\u914d\u7f6e",id:"\u914d\u7f6e",level:3},{value:"\u63d2\u4ef6",id:"\u63d2\u4ef6",level:2},{value:"axios-mock-adapter",id:"axios-mock-adapter",level:3},{value:"\u5efa\u8bae\u914d\u7f6e",id:"\u5efa\u8bae\u914d\u7f6e",level:2},{value:"\u53c2\u8003\u6587\u7ae0",id:"\u53c2\u8003\u6587\u7ae0",level:2}],u={toc:i},c="wrapper";function d(e){let{components:n,...t}=e;return(0,a.kt)(c,(0,r.Z)({},u,t,{components:n,mdxType:"MDXLayout"}),(0,a.kt)("blockquote",null,(0,a.kt)("p",{parentName:"blockquote"},"Create by ",(0,a.kt)("strong",{parentName:"p"},"fall")," on 2020-08-15\nRecently revised in 2022-12-17")),(0,a.kt)("h2",{id:"axios"},"axios"),(0,a.kt)("p",null,"\u57fa\u4e8e Promise\uff0c\u7528\u4e8e\u6d4f\u89c8\u5668\u548c node.js \u7684 HTTP \u5ba2\u6237\u7aef\uff08\u53ef\u4ee5\u8c03\u7528\u4e00\u4e2a http \u7684\u63a5\u53e3\uff09\uff0c\u80fd\u62e6\u622a\u8bf7\u6c42\u548c\u54cd\u5e94\uff0c\u81ea\u52a8\u8f6c\u5316 json \u6570\u636e\u3002"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"Promise \u5f02\u6b65\u5904\u7406"),(0,a.kt)("li",{parentName:"ul"},"\u62e6\u622a\u8bf7\u6c42\u548c\u76f8\u5e94"),(0,a.kt)("li",{parentName:"ul"},"\u652f\u6301\u9632\u5fa1 ",(0,a.kt)("a",{parentName:"li",href:"https://link.juejin.cn?target=https%3A%2F%2Fen.wikipedia.org%2Fwiki%2FCross-site_request_forgery"},"CSRF")," \u653b\u51fb"),(0,a.kt)("li",{parentName:"ul"},"\u8f6c\u6362\u8bf7\u6c42\u548c\u54cd\u5e94\u6570\u636e"),(0,a.kt)("li",{parentName:"ul"},"\u540c\u65f6\u652f\u6301\u6d4f\u89c8\u5668\u548c Node.js \u73af\u5883\uff1b")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-js"},"axios.get('/data')\n//\u4e5f\u53ef\u4ee5\u4f7f\u7528 restful\u65b9\u5f0f\u8fdb\u884c\u4f20\u8f93 axios.get('/data')\n.then(res=>{\n  console.log(res.data) // res.data\u83b7\u53d6\u540e\u53f0\u54cd\u5e94\u7684\u6570\u636e\n})\n")),(0,a.kt)("h3",{id:"\u8bf7\u6c42"},"\u8bf7\u6c42"),(0,a.kt)("p",null,(0,a.kt)("strong",{parentName:"p"},"\u76f4\u63a5\u8bf7\u6c42")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-js"},"axios('http://localhost:2525'{\n    method:\"get\"\n}).then(res)\n")),(0,a.kt)("p",null,(0,a.kt)("strong",{parentName:"p"},"get \u65b9\u5f0f\u8bf7\u6c42\u6570\u636e")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-js"},'axios.get({\n    url:"/hello",\n  // params \u53ef\u4ee5\u81ea\u52a8\u5c06\u5bf9\u8c61\u6570\u636e\u8f6c\u6362\u6210\u62fc\u63a5\u5b57\u7b26\u4e32\u8fdb\u884c\u4f20\u8f93\n  params:{\n    id:233\n  }\n}).then((res)=>{console.log(res.data)})\n')),(0,a.kt)("p",null,(0,a.kt)("strong",{parentName:"p"},"post \u6570\u636e\u7684\u4f20\u8f93")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-js"},"// \u7b2c\u4e00\u79cd post \u6570\u636e\u4f20\u8f93\u65b9\u5f0f\naxios.post('/data',postData).then(function(res){\n  console.log(res.data)\n})\n// \u7b2c\u4e8c\u79cd post \u6570\u636e\u7684\u4f20\u8f93\u65b9\u6cd5\nconst params = new URLSearchParams()\nparams.append('name','lihua')// \u53ef\u4ee5\u901a\u8fc7\u8be5\u65b9\u6cd5\u5199\u591a\u4e2a\u6570\u636e\naxios.post('/data',params).then(res=>{\n  console.log(res.data)\n})\n")),(0,a.kt)("p",null,(0,a.kt)("strong",{parentName:"p"},"put \u6570\u636e\u7684\u4f20\u8f93")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-js"},"axios.put('/data',{\n  id:10010,\n  data:\"\u8bf7\u4e0d\u8981\u56de\u5e94\"\n})\n")),(0,a.kt)("h3",{id:"\u8fd4\u56de\u5bf9\u8c61"},"\u8fd4\u56de\u5bf9\u8c61"),(0,a.kt)("p",null,"data\uff1a\u8fd4\u56de\u7684\u6570\u636e"),(0,a.kt)("p",null,"headers\uff1a\u54cd\u5e94\u5934\u4fe1\u606f"),(0,a.kt)("p",null,"status\uff1a\u54cd\u5e94\u72b6\u6001\u5417"),(0,a.kt)("p",null,"statusTest\uff1a\u54cd\u5e94\u72b6\u6001\u4fe1\u606f"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-js"},"axios.put('/data',{\n  username:'liushaoye'\n}).then(data=>{\n  console.log(data.status)\n  console.log(data.headers)\n})\n")),(0,a.kt)("h3",{id:"\u5168\u5c40\u914d\u7f6e"},"\u5168\u5c40\u914d\u7f6e"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-js"},"axios.defaults.timeout = 5000 // \u54cd\u5e94\u8d85\u65f6\u65f6\u95f4\naxios.defaults.baseURL = 'http://localhost:3000' // \u9ed8\u8ba4\u57fa\u51c6\u5730\u5740\naxios.defaults.headers['mytoken'] = 'adacocizuzxoui322ucuzcoiu' // \u8bbe\u7f6e\u54cd\u5e94\u5934\n")),(0,a.kt)("h3",{id:"\u62e6\u622a\u5668"},"\u62e6\u622a\u5668"),(0,a.kt)("p",null,"\u62e6\u622a\u5668\u6307\u5728\u7528\u6237\u8bf7\u6c42\uff0c\u5728\u8bf7\u6c42\u53d1\u9001\u5230\u670d\u52a1\u5668\u4e4b\u524d\u6dfb\u52a0\u4e00\u4e9b\u64cd\u4f5c"),(0,a.kt)("p",null,"\u4e00\u822c\u4f1a\u7528\u4e8e\u7528\u6237\u7684\u8ba4\u8bc1\uff0c\u8ba4\u8bc1\u901a\u8fc7\u540e\uff0c\u9700\u8981\u5728\u6bcf\u4e2a\u8bf7\u6c42\u4e0a\u90fd\u6dfb\u52a0\u8ba4\u8bc1\u4fe1\u606f\u3002\u6216\u8005\u662f\u5728\u670d\u52a1\u5668\u72b6\u6001\u7801\u4e3a 401\u65f6\uff0c\u81ea\u52a8\u8df3\u8f6c\u5230\u767b\u5f55\u754c\u9762\u3002"),(0,a.kt)("p",null,(0,a.kt)("strong",{parentName:"p"},"\u8bf7\u6c42\u62e6\u622a\u5668")),(0,a.kt)("p",null,"\u53d1\u9001\u7684\u8bf7\u6c42\u9700\u8981\u7ecf\u8fc7\u8bf7\u6c42\u62e6\u622a\u5668\u624d\u80fd\u8fdb\u884c\u53d1\u9001\uff0c\u9001\u5f80\u670d\u52a1\u5668\u3002"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-js"},"// \u53ef\u4ee5\u5411 use \u4e2d\u63d0\u4f9b\u4e24\u4e2a\u51fd\u6570\u4f5c\u4e3a\u53c2\u6570\uff0c\u5728\u6210\u529f\u65f6\u6267\u884c\uff0c\u6216\u8005\u5931\u8d25\u65f6\u6267\u884c\naxios.interceptors.request.use((config)=>{\n  console.log(config.url)\n  config.headers.mytoken = 'hello' // \u5728\u8bf7\u6c42\u5934\uff08header\uff09\u4e2d\u6dfb\u52a0\u4e86 mytoken : hello\n  return config\n},function(err){\n  console.log(err)\n})\n")),(0,a.kt)("p",null,(0,a.kt)("strong",{parentName:"p"},"\u54cd\u5e94\u62e6\u622a\u5668")),(0,a.kt)("p",null,"\u63a5\u53d7\u7684\u54cd\u5e94\uff0c\u7ecf\u8fc7\u54cd\u5e94\u62e6\u622a\u5668\uff0c\u8fdb\u884c\u52a0\u5de5\u5904\u7406\u4e4b\u540e\u624d\u4f1a\u88abaxios\u8fdb\u884c\u5904\u7406"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-js"},"axios.interreceptors.response.use(function(res){\n  // \u5bf9\u8fd4\u56de\u7684\u6570\u636e\u8fdb\u884c\u5904\u7406\uff0c\u53ea\u83b7\u53d6\u76f8\u5e94\u7684\u6570\u636e\uff0c\u4e0d\u9700\u8981\u54cd\u5e94\u5934\u5185\u5bb9\n  const data = res.data\n  return data // \u5fc5\u987b\u8981\u8fd4\u56de\u5185\u5bb9\uff0c\u7ed9\u4e0b\u4e00\u5c42 then \u8c03\u7528\n},function(err){\n  console.log('\u6709\u9519\u8bef\u4fe1\u606f'+err)\n  // \u5904\u7406\u54cd\u5e94\u9519\u8bef\u4fe1\u606f\n})\naxios.get('/data').then((res)=>{\n  console.log(res)// \u4e0a\u9762\u8fd4\u56de\u7684\u662f\u5c31\u662fres.data,\u6240\u4ee5\u53d6\u51fa\u7684\u503c\u4e3ares.data\n})\n")),(0,a.kt)("p",null,"\u4e2d\u65ad\uff08\u53d6\u6d88\uff09\u8bf7\u6c42"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-js"},"var CancelToken = axios.CancelToken\nvar source = CancelToken = CancelToken.source()\naxios.get('user',{\n  cancelToken:source.token\n})\n")),(0,a.kt)("h3",{id:"\u9002\u914d\u5668"},"\u9002\u914d\u5668"),(0,a.kt)("p",null,"\u901a\u8fc7\u9002\u914d\u5668\uff0caxios \u652f\u6301\u6d4f\u89c8\u5668\u548c node\uff0c\u6211\u4eec\u4e5f\u53ef\u4ee5\u901a\u8fc7\u81ea\u5b9a\u4e49\u9002\u914d\u5668\u7684\u65b9\u5f0f"),(0,a.kt)("p",null,"axios \u662f\u5982\u4f55\u533a\u5206 node \u8fd8\u662f\u6d4f\u89c8\u5668\u73af\u5883\u7684"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-js"},"function getDefaultAdapter() {\n  var adapter;\n  // \u901a\u8fc7\u6d4f\u89c8\u5668\u548c node \u72ec\u6709\u7684 API \u786e\u5b9a\u5f53\u524d\u73af\u5883\n  if (typeof XMLHttpRequest !== 'undefined') {\n    // For browsers use XHR adapter\n    adapter = require('./adapters/xhr');\n  } else if (typeof process !== 'undefined' && \n    Object.prototype.toString.call(process) === '[object process]') {\n    // For node use HTTP adapter\n    adapter = require('./adapters/http');\n  }\n  return adapter;\n}\n")),(0,a.kt)("h3",{id:"\u914d\u7f6e"},"\u914d\u7f6e"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-js"},"")),(0,a.kt)("p",null,"\u89e3\u51b3\u8de8\u57df\u95ee\u9898"),(0,a.kt)("p",null,"\u5982\u679c ",(0,a.kt)("inlineCode",{parentName:"p"},"server")," \u7aef\u662f\u81ea\u5df1\u5f00\u53d1\u7684\uff0c\u90a3\u4e48\u4fee\u6539\u76f8\u5173\u4ee3\u7801\u652f\u6301\u8de8\u57df\u5373\u53ef\u3002\u5982\u679c\u4e0d\u662f\u81ea\u5df1\u5f00\u53d1\u7684\uff0c\u90a3\u4e48\u53ef\u4ee5\u81ea\u5df1\u5199\u4e2a\u540e\u7aef\u8f6c\u53d1\u8be5\u8bf7\u6c42\uff0c\u7528\u4ee3\u7406\u7684\u65b9\u5f0f\u5b9e\u73b0\u3002"),(0,a.kt)("p",null,"\u8de8\u57df\u8fd9\u4e2a\u884c\u4e3a\u662f",(0,a.kt)("strong",{parentName:"p"},"\u6d4f\u89c8\u5668\u7981\u6b62"),"\uff08\u6d4f\u89c8\u5668\u4e0d\u5141\u8bb8\u5f53\u524d\u9875\u9762\u7684\u6240\u5728\u7684\u6e90\u53bb\u8bf7\u6c42\u53e6\u4e00\u4e2a\u6e90\u7684\u6570\u636e\uff09\u7684\uff0c\u4f46\u662f\u670d\u52a1\u7aef\u5e76\u4e0d\u7981\u6b62\u3002"),(0,a.kt)("h2",{id:"\u63d2\u4ef6"},"\u63d2\u4ef6"),(0,a.kt)("h3",{id:"axios-mock-adapter"},"axios-mock-adapter"),(0,a.kt)("p",null,"\u5b9e\u73b0 mock \u8bf7\u6c42"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-js"},'var axios = require("axios");\nvar MockAdapter = require("axios-mock-adapter");\n// \u5728\u9ed8\u8ba4\u7684Axios\u5b9e\u4f8b\u4e0a\u8bbe\u7f6emock\u9002\u914d\u5668\nvar mock = new MockAdapter(axios);\n// \u6a21\u62df GET /users \u8bf7\u6c42\nmock.onGet("/users").reply(200, {\n  users: [{ id: 1, name: "John Smith" }],\n});\n// \u8fdb\u884c\u8bf7\u6c42\naxios.get("/users").then(function (response) {\n  console.log(response.data);\n});\n')),(0,a.kt)("h2",{id:"\u5efa\u8bae\u914d\u7f6e"},"\u5efa\u8bae\u914d\u7f6e"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"\u6dfb\u52a0 ",(0,a.kt)("inlineCode",{parentName:"li"},"token")," \u9a8c\u8bc1"),(0,a.kt)("li",{parentName:"ul"},"\u63a7\u5236\u67d0\u4e9b\u8bf7\u6c42\u7684\u8c03\u7528\u9891\u7387"),(0,a.kt)("li",{parentName:"ul"},"\u6dfb\u52a0\u4e00\u4e9b\u5168\u5c40\u6d88\u606f\u63d0\u9192")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-js"},"import axios form 'axios'\naxios.defaults.timeout = 5000 // \u54cd\u5e94\u8d85\u65f6\u65f6\u95f4\naxios.defaults.baseURL = 'http://localhost:3000' // \u9ed8\u8ba4\u57fa\u51c6\u5730\u5740\naxios.interceptors.request.use((config)=>{\n  // ... \u5176\u5b83\u903b\u8f91\n  config.headers.token = \"input your token\"\n  return config // \u5fc5\u987b\u8fd4\u56de\u914d\u7f6e\n})\nimport config from './config'\nconst httpFetch = axios.create(config)\n// \u914d\u7f6e\u62e6\u622a\u8bf7\u6c42\nhttpFetch.interreceptors.request.use(req=>{\n  // setting\n  req.headers.token = 'set your token'\n})\nhttpFetch.interreceptors.response.use(res=>{\n  if(res.data && typeof res.data == 'string'){\n    res.data = JSON.parse(res.data)\n  }\n  // \u5176\u4ed6\u64cd\u4f5c\n})\n")),(0,a.kt)("h2",{id:"\u53c2\u8003\u6587\u7ae0"},"\u53c2\u8003\u6587\u7ae0"),(0,a.kt)("table",null,(0,a.kt)("thead",{parentName:"table"},(0,a.kt)("tr",{parentName:"thead"},(0,a.kt)("th",{parentName:"tr",align:null},"\u4f5c\u8005"),(0,a.kt)("th",{parentName:"tr",align:null},"\u6587\u7ae0\u5730\u5740"))),(0,a.kt)("tbody",{parentName:"table"},(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"\u3010vue\u5b66\u4e60\u3011axios"),(0,a.kt)("td",{parentName:"tr",align:null},(0,a.kt)("a",{parentName:"td",href:"https://www.jianshu.com/p/d771bbc61dab"},"https://www.jianshu.com/p/d771bbc61dab"))),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"\u963f\u5b9d\u54e5"),(0,a.kt)("td",{parentName:"tr",align:null},(0,a.kt)("a",{parentName:"td",href:"https://juejin.cn/post/6885471967714115597"},"https://juejin.cn/post/6885471967714115597"))),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null}),(0,a.kt)("td",{parentName:"tr",align:null})),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null}),(0,a.kt)("td",{parentName:"tr",align:null})))),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-js"},"export const handleRequestHeader = (config) => {\n  config.header['token'] = localStorage.getItem('token') || token || ''\n  config['xxxx'] = 'xxx'\n  return config\n}\nexport const handleLogout = ()=>{\n  message.info(\"\u7528\u6237\u5df2\u767b\u51fa\")\n}\nexport const handleNetworkError = (errStatus) => {\n  let errMessage = '\u672a\u77e5\u9519\u8bef'\n  if (errStatus) {\n    switch (errStatus) {\n      case 400:\n        errMessage = '\u9519\u8bef\u7684\u8bf7\u6c42';        break\n      case 401:\n        errMessage = '\u672a\u6388\u6743\uff0c\u8bf7\u91cd\u65b0\u767b\u5f55';        break\n      case 403:\n        errMessage = '\u62d2\u7edd\u8bbf\u95ee';        break\n      case 404:\n        errMessage = '\u8bf7\u6c42\u9519\u8bef,\u672a\u627e\u5230\u8be5\u8d44\u6e90';        break\n      case 405:\n        errMessage = '\u8bf7\u6c42\u65b9\u6cd5\u672a\u5141\u8bb8';        break\n      case 408:\n        errMessage = '\u8bf7\u6c42\u8d85\u65f6';        break\n      case 500:\n        errMessage = '\u670d\u52a1\u5668\u7aef\u51fa\u9519';        break\n      case 501:\n        errMessage = '\u7f51\u7edc\u672a\u5b9e\u73b0';        break\n      case 502:\n        errMessage = '\u7f51\u7edc\u9519\u8bef';        break\n      case 503:\n        errMessage = '\u670d\u52a1\u4e0d\u53ef\u7528';        break\n      case 504:\n        errMessage = '\u7f51\u7edc\u8d85\u65f6';        break\n      case 505:\n        errMessage = 'http\u7248\u672c\u4e0d\u652f\u6301\u8be5\u8bf7\u6c42';        break\n      default:\n        errMessage = `\u5176\u4ed6\u8fde\u63a5\u9519\u8bef --${errStatus}`\n    }\n  } else {\n    errMessage = `\u65e0\u6cd5\u8fde\u63a5\u5230\u670d\u52a1\u5668\uff01`\n  }\n  message.error(errMessage)\n}\nexport const handleAuthError = (errno) => {\n  const authErrMap = {\n    '10031': '\u767b\u5f55\u5931\u6548\uff0c\u9700\u8981\u91cd\u65b0\u767b\u5f55', // token \u5931\u6548\n    '10032': '\u60a8\u592a\u4e45\u6ca1\u767b\u5f55\uff0c\u8bf7\u91cd\u65b0\u767b\u5f55~', // token \u8fc7\u671f\n    '10033': '\u8d26\u6237\u672a\u7ed1\u5b9a\u89d2\u8272\uff0c\u8bf7\u8054\u7cfb\u7ba1\u7406\u5458\u7ed1\u5b9a\u89d2\u8272',\n    '10034': '\u8be5\u7528\u6237\u672a\u6ce8\u518c\uff0c\u8bf7\u8054\u7cfb\u7ba1\u7406\u5458\u6ce8\u518c\u7528\u6237',\n    '10035': 'code \u65e0\u6cd5\u83b7\u53d6\u5bf9\u5e94\u7b2c\u4e09\u65b9\u5e73\u53f0\u7528\u6237',\n    '10036': '\u8be5\u8d26\u6237\u672a\u5173\u8054\u5458\u5de5\uff0c\u8bf7\u8054\u7cfb\u7ba1\u7406\u5458\u505a\u5173\u8054',\n    '10037': '\u8d26\u53f7\u5df2\u65e0\u6548',\n    '10038': '\u8d26\u53f7\u672a\u627e\u5230',\n  }\n  if (authErrMap.hasOwnProperty(errno)) {\n    message.error(authErrMap[errno])\n    // \u6388\u6743\u9519\u8bef\uff0c\u767b\u51fa\u8d26\u6237\n    handleLogout()\n    return false\n  }\n  return true\n}\nconst handleGeneralError = (errno, errmsg) => {\n  if (err.errno !== '0') {\n    meessage.error(err.errmsg)\n    return false\n  }\n  return true\n}\n")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-js"},"import axios from 'axios'\nimport { message } from 'antd'\nimport {\n  handleChangeRequestHeader,\n  handleConfigureAuth,\n  handleAuthError,\n  handleGeneralError,\n  handleNetworkError\n} from './tools'\ntype Fn = (data: FcResponse<any>) => unknown\naxios.interceptors.request.use((config) => {\n  config = handleChangeRequestHeader(config)\n  config = handleConfigureAuth(config)\n  return config\n})\naxios.interceptors.response.use(\n  (response) => {\n    if (response.status !== 200) return Promise.reject(response.data)\n    handleAuthError(response.data.errno)\n    handleGeneralError(response.data.errno, response.data.errmsg)\n    return response\n  },\n  (err) => {\n    handleNetworkError(err.response.status)\n    Promise.reject(err.response)\n  }\n)\nexport const Get = <T,>(url, params, clearFn) => new Promise((resolve) => {\n  axios.get(url, { params }).then((result) => {\n    let res: FcResponse<T>\n      if (clearFn !== undefined) {\n        res = clearFn(result.data) as unknown as FcResponse<T>\n      } else {\n        res = result.data as FcResponse<T>\n      }\n        resolve([null, res as FcResponse<T>])\n      })\n        .catch((err) => {\n          resolve([err, undefined])\n        })\n      })\nexport const Post = (url, data, params) => {\n    return new Promise((resolve) => {\n      axios.post(url, data, { params }).then((result) => {\n        resolve([null, result.data as FcResponse<T>])\n      })\n        .catch((err) => {\n        resolve([err, undefined])\n      })\n    })\n  }\n")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-js"},'import { userApi } from "./path/user"\nimport { shoporderApi } from "./path/shoporder"\nexport const api = {\n    ...userApi,\n    ...shoporderApi\n}\n')),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-js"},'import { Get } from "../server"\nexport function getUserInfo(id) { ... }\nexport function getUserName(id) { ... }\nexport const userApi = {\n    getUserInfo,\n    getUserName\n}\n')),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-js"},'import { Get } from "../server"\nfunction getShoporderDetail() { ... }\nfunction getShoporderList() { ... }\nexport const shoporderApi = {\n    getShoporderDetail,\n    getShoporderList\n}\n')))}d.isMDXComponent=!0}}]);